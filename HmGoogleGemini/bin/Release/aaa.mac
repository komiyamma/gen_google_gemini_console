jsmode "WebView2";
js {
let curmacdir = currentmacrodirectory();
function isX64Hidemaru() {
    return platform() & 0x00080000;
}

let dll = null;
if (isX64Hidemaru()) {
    dll = loaddll( curmacdir + "\\HmGetTempPath_x64.dll" );
} else {
    dll = loaddll( curmacdir + "\\HmGetTempPath_x86.dll" );
}

let path = dll.dllFuncStrW.HmGetTempPath();
debuginfo(2);
if (selecting()) {
try {
    var text = hidemaru.getSelectedText();
    runex( curmacdir + "\\HmGoogleGemini.exe", 0);

    let ticknum = tickcount() & 0x7fffffff;
    let header = "HmGoogleGemini.Message(" + ticknum + ")\n";
    var saveFileName = path + "HmGoogleGemini.question.txt";
    hidemaru.setTimeout((saveFileName)=>{console.log(saveFileName);console.log(text);hidemaru.saveTextFile(saveFileName, header + text, "utf8");}, 200, saveFileName);

/*
hidemaru.setTimeout((saveFileName)=>{console.log(saveFileName);console.log(text);
let dll2 = loaddll( curmacdir + "\\HmSaveTextFile.dll" );
    dll2.dllFuncW.HmSaveTextFile(saveFileName);


}, 500, saveFileName);
 */   
} catch(err) {
    console.log(err);
}
}

}
